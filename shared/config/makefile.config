#
# Main configuration file for all parts of ANaConDA.
#
# Contains definitions of variables necessary to build the ANaConDA framework,
#   its wrappers and analysers.
#
# File:      makefile.config
# Author:    Jan Fiedor (fiedorjan@centrum.cz)
# Date:      Created 2012-02-21
# Date:      Last Update 2014-10-03
# Version:   0.4
#

# Basic variables
# ---------------

# Are we building a debug version? If yes, set DEBUG=1 before configuring PIN!
ifeq ($(findstring debug, $(MAKECMDGOALS)), debug)
  DEBUG=1
endif

# PIN variables
# -------------

# A root directory where the PIN framework is installed
PIN_ROOT ?= $(PIN_HOME)

# A directory containing PIN configuration files 
ifdef PIN_ROOT
  CONFIG_ROOT := $(PIN_ROOT)/source/tools/Config
else
  CONFIG_ROOT := ../Config
endif

# Include the variables necessary to build with PIN
include $(CONFIG_ROOT)/makefile.config

# ANaConDA variables
# ------------------

# Build the IA32 and Intel64 versions separately
BUILD_DIR = ./build/$(HOST_ARCH)

# The CMake executable we will use to perform the build 
CMAKE ?= cmake
# We need to pass some information set by the PIN's Makefiles to CMake
CMAKE_PIN_FLAGS  = -DTARGET_LONG="$(HOST_ARCH)"
CMAKE_PIN_FLAGS += -DCXX="$(CXX)"
CMAKE_PIN_FLAGS += -DPIN_CXXFLAGS="$(TOOL_CXXFLAGS)"
CMAKE_PIN_FLAGS += -DPIN_LDFLAGS="$(TOOL_LDFLAGS)"
CMAKE_PIN_FLAGS += -DPIN_LPATHS="$(TOOL_LPATHS)"
CMAKE_PIN_FLAGS += -DPIN_LIBS="$(TOOL_LIBS)"
# General CMake parameters used in all types of build (debug, release, etc.)
CMAKE_FLAGS = -DCMAKE_INSTALL_PREFIX=../.. $(CMAKE_PIN_FLAGS)

# End of file makefile.config
